this one profiles the code with tripartitions arrays coalescing as well
