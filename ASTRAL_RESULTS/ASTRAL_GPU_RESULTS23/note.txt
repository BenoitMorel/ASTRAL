tried some optimizations with calculating weight
